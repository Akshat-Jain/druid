{"multiStageQuery":{"type":"multiStageQuery","taskId":"query-c1513fe6-5bb1-4560-9138-f41317d2640b","payload":{"status":{"status":"FAILED","errorReport":{"taskId":"query-c1513fe6-5bb1-4560-9138-f41317d2640b-worker0_0","host":"localhost:8101","stageNumber":0,"error":{"errorCode":"UnknownError","message":"java.lang.RuntimeException: org.apache.druid.error.DruidException: Function[CAST] encountered unknown exception.","errorMessage":"java.lang.RuntimeException: org.apache.druid.error.DruidException: Function[CAST] encountered unknown exception."},"exceptionStackTrace":"java.lang.RuntimeException: org.apache.druid.error.DruidException: Function[CAST] encountered unknown exception.\n\tat org.apache.druid.java.util.common.Either.valueOrThrow(Either.java:95)\n\tat org.apache.druid.frame.processor.FrameProcessorExecutor$1ExecutorRunnable.runProcessorNow(FrameProcessorExecutor.java:259)\n\tat org.apache.druid.frame.processor.FrameProcessorExecutor$1ExecutorRunnable.run(FrameProcessorExecutor.java:138)\n\tat org.apache.druid.msq.exec.WorkerImpl$1$2.run(WorkerImpl.java:836)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n\tat org.apache.druid.query.PrioritizedListenableFutureTask.run(PrioritizedExecutorService.java:259)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\nCaused by: org.apache.druid.error.DruidException: Function[CAST] encountered unknown exception.\n\tat org.apache.druid.error.DruidException$DruidExceptionBuilder.build(DruidException.java:460)\n\tat org.apache.druid.math.expr.FunctionExpr.eval(FunctionalExpr.java:219)\n\tat org.apache.druid.math.expr.ExpressionPredicateIndexSupplier$ExpressionPredicateIndexes.lambda$forPredicate$1(ExpressionPredicateIndexSupplier.java:79)\n\tat org.apache.druid.math.expr.ExpressionPredicateIndexSupplier$2.nextMatches(ExpressionPredicateIndexSupplier.java:133)\n\tat org.apache.druid.math.expr.ExpressionPredicateIndexSupplier$BitmapIterator.findNext(ExpressionPredicateIndexSupplier.java:254)\n\tat org.apache.druid.math.expr.ExpressionPredicateIndexSupplier$BitmapIterator.hasNext(ExpressionPredicateIndexSupplier.java:232)\n\tat org.apache.druid.collections.bitmap.RoaringBitmapFactory$1$1.hasNext(RoaringBitmapFactory.java:78)\n\tat org.roaringbitmap.buffer.BufferFastAggregation.naive_or(BufferFastAggregation.java:781)\n\tat org.roaringbitmap.buffer.BufferFastAggregation.or(BufferFastAggregation.java:875)\n\tat org.roaringbitmap.buffer.ImmutableRoaringBitmap.or(ImmutableRoaringBitmap.java:875)\n\tat org.apache.druid.collections.bitmap.RoaringBitmapFactory.union(RoaringBitmapFactory.java:142)\n\tat org.apache.druid.query.DefaultBitmapResultFactory.unionDimensionValueBitmaps(DefaultBitmapResultFactory.java:73)\n\tat org.apache.druid.query.DefaultBitmapResultFactory.unionDimensionValueBitmaps(DefaultBitmapResultFactory.java:25)\n\tat org.apache.druid.segment.index.DictionaryScanningBitmapIndex.computeBitmapResult(DictionaryScanningBitmapIndex.java:64)\n\tat org.apache.druid.query.filter.Filter.makeFilterBundle(Filter.java:78)\n\tat org.apache.druid.segment.QueryableIndexCursorSequenceBuilder.makeFilterBundle(QueryableIndexCursorSequenceBuilder.java:294)\n\tat org.apache.druid.segment.QueryableIndexCursorSequenceBuilder.build(QueryableIndexCursorSequenceBuilder.java:113)\n\tat org.apache.druid.segment.QueryableIndexStorageAdapter.makeCursors(QueryableIndexStorageAdapter.java:271)\n\tat org.apache.druid.msq.querykit.scan.ScanQueryFrameProcessor.makeCursors(ScanQueryFrameProcessor.java:445)\n\tat org.apache.druid.msq.querykit.scan.ScanQueryFrameProcessor.runWithSegment(ScanQueryFrameProcessor.java:261)\n\tat org.apache.druid.msq.querykit.BaseLeafFrameProcessor.runIncrementally(BaseLeafFrameProcessor.java:88)\n\tat org.apache.druid.msq.querykit.scan.ScanQueryFrameProcessor.runIncrementally(ScanQueryFrameProcessor.java:162)\n\tat org.apache.druid.frame.processor.FrameProcessors$1FrameProcessorWithBaggage.runIncrementally(FrameProcessors.java:75)\n\tat org.apache.druid.frame.processor.FrameProcessorExecutor$1ExecutorRunnable.runProcessorNow(FrameProcessorExecutor.java:230)\n\t... 8 more\nCaused by: org.apache.druid.java.util.common.ISE: Lookup [test-lookup-3] not found\n\tat org.apache.druid.query.lookup.RegisteredLookupExtractionFn.lambda$ensureDelegate$0(RegisteredLookupExtractionFn.java:163)\n\tat java.base/java.util.Optional.orElseThrow(Optional.java:408)\n\tat org.apache.druid.query.lookup.RegisteredLookupExtractionFn.ensureDelegate(RegisteredLookupExtractionFn.java:163)\n\tat org.apache.druid.query.lookup.RegisteredLookupExtractionFn.apply(RegisteredLookupExtractionFn.java:126)\n\tat org.apache.druid.query.expression.LookupExprMacro$1LookupExpr.eval(LookupExprMacro.java:91)\n\tat org.apache.druid.math.expr.Function$BivariateFunction.apply(Function.java:192)\n\tat org.apache.druid.math.expr.FunctionExpr.eval(FunctionalExpr.java:202)\n\t... 30 more\n"},"startTime":"2024-04-16T07:10:00.642Z","durationMs":14189,"workers":{"0":[{"workerId":"query-c1513fe6-5bb1-4560-9138-f41317d2640b-worker0_0","state":"FAILED","durationMs":13785,"pendingMs":106}]},"pendingTasks":0,"runningTasks":1},"stages":[{"stageNumber":0,"definition":{"id":"query-c1513fe6-5bb1-4560-9138-f41317d2640b_0","input":[{"type":"table","dataSource":"inline_data_2","intervals":["-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z"],"filter":{"type":"equals","column":"v0","matchValueType":"LONG","matchValue":1},"filterFields":["v0"]}],"processor":{"type":"scan","query":{"queryType":"scan","dataSource":{"type":"inputNumber","inputNumber":0},"intervals":{"type":"intervals","intervals":["-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z"]},"virtualColumns":[{"type":"expression","name":"v0","expression":"CAST(lookup(\"name\",'test-lookup-3'), 'LONG')","outputType":"LONG"}],"resultFormat":"compactedList","limit":1001,"filter":{"type":"equals","column":"v0","matchValueType":"LONG","matchValue":1},"columns":["__time","age","country","grade","name","rollNumber"],"legacy":false,"context":{"__resultFormat":"array","__user":"allowAll","executionMode":"async","finalize":true,"maxNumTasks":2,"maxParseExceptions":0,"queryId":"c1513fe6-5bb1-4560-9138-f41317d2640b","scanSignature":"[{\"name\":\"__time\",\"type\":\"LONG\"},{\"name\":\"age\",\"type\":\"LONG\"},{\"name\":\"country\",\"type\":\"STRING\"},{\"name\":\"grade\",\"type\":\"STRING\"},{\"name\":\"name\",\"type\":\"STRING\"},{\"name\":\"rollNumber\",\"type\":\"LONG\"}]","snapshotWorkingDir":"/tmp","sqlOuterLimit":1001,"sqlQueryId":"c1513fe6-5bb1-4560-9138-f41317d2640b","sqlStringifyArrays":false},"columnTypes":["LONG","LONG","STRING","STRING","STRING","LONG"],"granularity":{"type":"all"}}},"signature":[{"name":"__time","type":"LONG"},{"name":"age","type":"LONG"},{"name":"country","type":"STRING"},{"name":"grade","type":"STRING"},{"name":"name","type":"STRING"},{"name":"rollNumber","type":"LONG"}],"shuffleSpec":{"type":"mix"},"maxWorkerCount":1},"workerCount":1,"partitionCount":1,"startTime":"2024-04-16T07:10:00.890Z","duration":13938},{"stageNumber":1,"definition":{"id":"query-c1513fe6-5bb1-4560-9138-f41317d2640b_1","input":[{"type":"stage","stage":0}],"processor":{"type":"limit","limit":1001},"signature":[{"name":"__time","type":"LONG"},{"name":"age","type":"LONG"},{"name":"country","type":"STRING"},{"name":"grade","type":"STRING"},{"name":"name","type":"STRING"},{"name":"rollNumber","type":"LONG"}],"maxWorkerCount":1}}],"counters":{"0":{"0":{"input0":{"type":"channel","totalFiles":[3]}}}}}}}