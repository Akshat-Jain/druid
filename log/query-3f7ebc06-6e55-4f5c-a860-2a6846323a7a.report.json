{"multiStageQuery":{"type":"multiStageQuery","taskId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a","payload":{"status":{"status":"FAILED","errorReport":{"taskId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a","host":"localhost:8100","error":{"errorCode":"WorkerRpcFailed","workerTaskId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0","errorMessage":"RPC call to task failed unrecoverably: [query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0]"},"exceptionStackTrace":"java.lang.RuntimeException: org.apache.druid.msq.indexing.error.MSQException: WorkerRpcFailed: RPC call to task failed unrecoverably: [query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0]\n\tat org.apache.druid.common.guava.FutureUtils.getUnchecked(FutureUtils.java:83)\n\tat org.apache.druid.msq.exec.ControllerImpl.contactWorkersForStage(ControllerImpl.java:1394)\n\tat org.apache.druid.msq.exec.ControllerImpl.startWorkForStage(ControllerImpl.java:1425)\n\tat org.apache.druid.msq.exec.ControllerImpl.access$1500(ControllerImpl.java:247)\n\tat org.apache.druid.msq.exec.ControllerImpl$RunQueryUntilDone.startStages(ControllerImpl.java:2804)\n\tat org.apache.druid.msq.exec.ControllerImpl$RunQueryUntilDone.run(ControllerImpl.java:2547)\n\tat org.apache.druid.msq.exec.ControllerImpl$RunQueryUntilDone.access$000(ControllerImpl.java:2504)\n\tat org.apache.druid.msq.exec.ControllerImpl.runTask(ControllerImpl.java:414)\n\tat org.apache.druid.msq.exec.ControllerImpl.run(ControllerImpl.java:353)\n\tat org.apache.druid.msq.indexing.MSQControllerTask.runTask(MSQControllerTask.java:250)\n\tat org.apache.druid.indexing.common.task.AbstractTask.run(AbstractTask.java:179)\n\tat org.apache.druid.indexing.overlord.SingleTaskBackgroundRunner$SingleTaskBackgroundRunnerCallable.call(SingleTaskBackgroundRunner.java:478)\n\tat org.apache.druid.indexing.overlord.SingleTaskBackgroundRunner$SingleTaskBackgroundRunnerCallable.call(SingleTaskBackgroundRunner.java:450)\n\tat com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:131)\n\tat com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:75)\n\tat com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:82)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\nCaused by: org.apache.druid.msq.indexing.error.MSQException: WorkerRpcFailed: RPC call to task failed unrecoverably: [query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0]\n\tat org.apache.druid.msq.exec.ExceptionWrappingWorkerClient$1.onFailure(ExceptionWrappingWorkerClient.java:160)\n\tat com.google.common.util.concurrent.Futures$CallbackListener.run(Futures.java:1119)\n\tat com.google.common.util.concurrent.DirectExecutor.execute(DirectExecutor.java:31)\n\tat com.google.common.util.concurrent.AbstractFuture.executeListener(AbstractFuture.java:1286)\n\tat com.google.common.util.concurrent.AbstractFuture.complete(AbstractFuture.java:1055)\n\tat com.google.common.util.concurrent.AbstractFuture.setException(AbstractFuture.java:807)\n\tat com.google.common.util.concurrent.SettableFuture.setException(SettableFuture.java:55)\n\tat org.apache.druid.rpc.ServiceClientImpl$2.onSuccess(ServiceClientImpl.java:406)\n\tat org.apache.druid.rpc.ServiceClientImpl$2.onSuccess(ServiceClientImpl.java:401)\n\tat com.google.common.util.concurrent.Futures$CallbackListener.run(Futures.java:1133)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n\tat java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)\n\t... 3 more\nCaused by: org.apache.druid.rpc.ServiceClosedException: Service [query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0] is closed\n\t... 9 more\n"},"startTime":"2024-04-13T03:58:14.784Z","durationMs":8951,"workers":{"0":[{"workerId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker0_0","state":"FAILED","durationMs":-1,"pendingMs":107}],"1":[{"workerId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker1_0","state":"FAILED","durationMs":83,"pendingMs":215}],"2":[{"workerId":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a-worker2_0","state":"FAILED","durationMs":84,"pendingMs":218}]},"pendingTasks":0,"runningTasks":1},"stages":[{"stageNumber":0,"definition":{"id":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a_0","input":[{"type":"table","dataSource":"inline_data_2","intervals":["-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z"],"filter":{"type":"equals","column":"v0","matchValueType":"LONG","matchValue":1},"filterFields":["v0"]}],"processor":{"type":"scan","query":{"queryType":"scan","dataSource":{"type":"inputNumber","inputNumber":0},"intervals":{"type":"intervals","intervals":["-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z"]},"virtualColumns":[{"type":"expression","name":"v0","expression":"CAST(lookup(\"name\",'test-lookup-3'), 'LONG')","outputType":"LONG"}],"resultFormat":"compactedList","limit":1001,"filter":{"type":"equals","column":"v0","matchValueType":"LONG","matchValue":1},"columns":["__time","age","country","grade","name","rollNumber"],"legacy":false,"context":{"__resultFormat":"array","__user":"allowAll","executionMode":"async","finalize":true,"maxNumTasks":4,"maxParseExceptions":0,"queryId":"3f7ebc06-6e55-4f5c-a860-2a6846323a7a","scanSignature":"[{\"name\":\"__time\",\"type\":\"LONG\"},{\"name\":\"age\",\"type\":\"LONG\"},{\"name\":\"country\",\"type\":\"STRING\"},{\"name\":\"grade\",\"type\":\"STRING\"},{\"name\":\"name\",\"type\":\"STRING\"},{\"name\":\"rollNumber\",\"type\":\"LONG\"}]","sqlOuterLimit":1001,"sqlQueryId":"3f7ebc06-6e55-4f5c-a860-2a6846323a7a","sqlStringifyArrays":false},"columnTypes":["LONG","LONG","STRING","STRING","STRING","LONG"],"granularity":{"type":"all"}}},"signature":[{"name":"__time","type":"LONG"},{"name":"age","type":"LONG"},{"name":"country","type":"STRING"},{"name":"grade","type":"STRING"},{"name":"name","type":"STRING"},{"name":"rollNumber","type":"LONG"}],"shuffleSpec":{"type":"mix"},"maxWorkerCount":3},"startTime":"2024-04-13T03:58:15.128Z","duration":8607},{"stageNumber":1,"definition":{"id":"query-3f7ebc06-6e55-4f5c-a860-2a6846323a7a_1","input":[{"type":"stage","stage":0}],"processor":{"type":"limit","limit":1001},"signature":[{"name":"__time","type":"LONG"},{"name":"age","type":"LONG"},{"name":"country","type":"STRING"},{"name":"grade","type":"STRING"},{"name":"name","type":"STRING"},{"name":"rollNumber","type":"LONG"}],"maxWorkerCount":1}}],"counters":{}}}}